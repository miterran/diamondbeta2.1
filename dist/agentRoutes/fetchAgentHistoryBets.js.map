{"version":3,"sources":["../../src/agentRoutes/fetchAgentHistoryBets.js"],"names":["HistoryBet","router","Router","post","req","res","weekNum","body","find","agent","user","username","completedAt","$gte","startOf","subtract","add","format","$lte","endOf","err","result","status","send","json"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AADA,IAAMA,aAAa,mBAASA,UAA5B;;AAEA,IAAMC,SAAS,kBAAQC,MAAR,EAAf;;AAEAD,OAAOE,IAAP,CAAY,qBAAZ,EAAmC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChD,KAAMC,UAAUF,IAAIG,IAAJ,CAASD,OAAzB;AACAN,YAAWQ,IAAX,CAAgB,EAACC,OAAOL,IAAIM,IAAJ,CAASC,QAAjB,EAA2BC,aAAa,EAACC,MAAM,wBAASC,OAAT,CAAiB,MAAjB,EAAyBC,QAAzB,CAAkCT,OAAlC,EAA2C,KAA3C,EAAkDU,GAAlD,CAAsD,CAAtD,EAAyD,KAAzD,EAAgEC,MAAhE,EAAP,EAAiFC,MAAM,wBAASC,KAAT,CAAe,MAAf,EAAuBJ,QAAvB,CAAgCT,OAAhC,EAAyC,KAAzC,EAAgDU,GAAhD,CAAoD,CAApD,EAAuD,KAAvD,EAA8DC,MAA9D,EAAvF,EAAxC,EAAhB,EAAyN,UAASG,GAAT,EAAcC,MAAd,EAAqB;AAC7O,MAAGD,GAAH,EAAQf,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,+BAArB;AACRlB,MAAImB,IAAJ,CAASH,MAAT;AACA,EAHD;AAIA,CAND;;kBASepB,M","file":"fetchAgentHistoryBets.js","sourcesContent":["import _ from 'lodash';\nimport moment from 'moment';\nimport BetOrder from '../models/BetOrder'\nconst HistoryBet = BetOrder.HistoryBet\nimport express from 'express';\nconst router = express.Router();\n\nrouter.post('/fetch-history-bets', (req, res) => {\n\tconst weekNum = req.body.weekNum\n\tHistoryBet.find({agent: req.user.username, completedAt: {$gte: moment().startOf('week').subtract(weekNum, 'day').add(0, 'day').format(), $lte: moment().endOf('week').subtract(weekNum, 'day').add(0, 'day').format()}}, function(err, result){\n\t\tif(err) res.status(404).send('fetch agent history bet error')\n\t\tres.json(result)\n\t})\n})\n\n\nexport default router;\n\n"]}