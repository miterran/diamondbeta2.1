{"version":3,"sources":["../src/index.js"],"names":["use","Promise","global","connect","mongoURL","app","server","createServer","initialize","json","urlencoded","extended","static","resolve","__dirname","get","req","res","send","authenticate","session","request","response","sendFile","scheduleJob","console","log","Date","listen","process","env","PORT","address","port"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;AAIA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;;;AArBA,mBAASA,GAAT;;AAGA,mBAASC,OAAT,GAAmBC,OAAOD,OAA1B,CAAkC;AAClC,mBAASE,OAAT,CAAiB,iBAAOC,QAAxB;;AAoBA,IAAIC,MAAM,wBAAV;AACAA,IAAIC,MAAJ,GAAa,eAAKC,YAAL,CAAkBF,GAAlB,CAAb;;AAEA;AACAA,IAAIL,GAAJ,CAAQ,sBAAO,KAAP,CAAR;;AAEA;AACAK,IAAIL,GAAJ,CAAQ,uBAAR;AACAK,IAAIL,GAAJ,CAAQ,qBAAR;AACAK,IAAIL,GAAJ,CAAQ,4BAAR;AACAK,IAAIL,GAAJ,CAAQ,+BAAR;;AAEAK,IAAIL,GAAJ,CAAQ,mBAASQ,UAAT,EAAR;;AAEAH,IAAIL,GAAJ,CAAQ,qBAAWS,IAAX,EAAR;AACAJ,IAAIL,GAAJ,CAAQ,qBAAWU,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;;AAEAN,IAAIL,GAAJ,CAAQ,kBAAQY,MAAR,CAAe,eAAKC,OAAL,CAAaC,SAAb,EAAwB,iBAAxB,CAAf,CAAR;;AAEAT,IAAIU,GAAJ,CAAQ,MAAR,EAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7BA,KAAIC,IAAJ,CAAS,UAAT;AACA,CAFD;;AAIAb,IAAIL,GAAJ,CAAQ,MAAR;AACAK,IAAIL,GAAJ,CAAQ,MAAR;;AAEAK,IAAIL,GAAJ,CAAQ,WAAR,EAAqB,mBAASmB,YAAT,CAAsB,KAAtB,EAA6B,EAACC,SAAS,KAAV,EAA7B,CAArB;AACAf,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;AACAK,IAAIL,GAAJ,CAAQ,WAAR;;AAEAK,IAAIL,GAAJ,CAAQ,YAAR,EAAsB,mBAASmB,YAAT,CAAsB,KAAtB,EAA6B,EAACC,SAAS,KAAV,EAA7B,CAAtB;AACAf,IAAIL,GAAJ,CAAQ,YAAR;;AAEAK,IAAIU,GAAJ,CAAQ,GAAR,EAAa,UAASM,OAAT,EAAkBC,QAAlB,EAA4B;AACvCA,UAASC,QAAT,CAAkB,eAAKV,OAAL,CAAaC,SAAb,EAAwB,iBAAxB,EAA2C,YAA3C,CAAlB;AACD,CAFD;;AAIA,uBAASU,WAAT,CAAqB,YAArB,4CAAmC;AAAA;AAAA;AAAA;AAAA;AAClCC,aAAQC,GAAR,CAAY,IAAIC,IAAJ,EAAZ;AADkC;AAAA,YAE5B,+BAF4B;;AAAA;AAAA;AAAA,YAG5B,8BAH4B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAnC;;AAMAtB,IAAIC,MAAJ,CAAWsB,MAAX,CAAkBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAtC,EAA4C,YAAM;AACjDN,SAAQC,GAAR,sBAA+BrB,IAAIC,MAAJ,CAAW0B,OAAX,GAAqBC,IAApD;AACA,CAFD;;kBAIe5B,G","file":"index.js","sourcesContent":["import \"babel-polyfill\";\nimport path from 'path';\nimport config from './config';\nimport http from 'http';\nimport express from 'express';\nimport cors from 'cors';\nimport morgan from 'morgan';\nimport bodyParser from 'body-parser';\nimport compress from 'compression';\nimport helmet from 'helmet';\nimport methodOverride from 'method-override';\nimport passport from \"passport\";\nimport JwtStrategy from './middleware/JwtStrategy';\npassport.use(JwtStrategy)\n\nimport mongoose from 'mongoose';\nmongoose.Promise = global.Promise;;\nmongoose.connect(config.mongoURL);\n\nimport fetchLeagues from './userRoutes/fetchLeagues';\nimport queryOdds from './userRoutes/queryOdds';\nimport straightWagerSubmit from './userRoutes/straightWagerSubmit';\nimport parlayWagerSubmit from './userRoutes/parlayWagerSubmit';\nimport fetchOpenBets from './userRoutes/fetchOpenBets';\nimport fetchHistoryBets from './userRoutes/fetchHistoryBets';\nimport fetchUserState from './userRoutes/fetchUserState';\n\nimport fetchAgentState from './agentRoutes/fetchAgentState';\n\nimport authLogin from './routes/authLogin';\nimport confirmEventsResult from './routes/confirmEventsResult';\n\nimport schedule from 'node-schedule';\nimport openBetPending from './schedule/openBetPending'\nimport openBetResult from './schedule/openBetResult'\n\n\nlet app = express();\napp.server = http.createServer(app);\n\n// logger\napp.use(morgan('dev'));\n\n// 3rd party middleware\napp.use(helmet());\napp.use(cors());\napp.use(compress());\napp.use(methodOverride());\n\napp.use(passport.initialize());\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.use(express.static(path.resolve(__dirname, '../client/build')));\n\napp.get('/api', (req, res) => {\n\tres.send('test api')\n})\n\napp.use('/api', authLogin)\napp.use('/api', confirmEventsResult)\n\napp.use('/api/user', passport.authenticate('jwt', {session: false}))\napp.use('/api/user', fetchLeagues);\napp.use('/api/user', queryOdds);\napp.use('/api/user', straightWagerSubmit);\napp.use('/api/user', parlayWagerSubmit);\napp.use('/api/user', fetchOpenBets);\napp.use('/api/user', fetchHistoryBets);\napp.use('/api/user', fetchUserState);\n\napp.use('/api/agent', passport.authenticate('jwt', {session: false}));\napp.use('/api/agent', fetchAgentState);\n\napp.get('*', function(request, response) {\n  response.sendFile(path.resolve(__dirname, '../client/build', 'index.html'));\n});\n\nschedule.scheduleJob('59 * * * *', async function(){\n\tconsole.log(new Date())\n\tawait openBetPending()\n\tawait openBetResult()\n});\n\napp.server.listen(process.env.PORT || 8080, () => {\n\tconsole.log(`Started on port ${app.server.address().port}`);\n});\n\nexport default app;\n"]}