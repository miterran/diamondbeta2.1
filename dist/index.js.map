{"version":3,"sources":["../src/index.js"],"names":["use","Promise","global","connect","mongoURL","useMongoClient","app","server","createServer","initialize","json","urlencoded","extended","static","resolve","__dirname","get","req","res","send","authenticate","session","request","response","sendFile","scheduleJob","console","log","Date","listen","process","env","PORT","address","port"],"mappings":"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","file":"index.js","sourcesContent":["import \"babel-polyfill\";\nimport path from 'path';\nimport config from './config';\nimport http from 'http';\nimport express from 'express';\nimport cors from 'cors';\nimport morgan from 'morgan';\nimport bodyParser from 'body-parser';\nimport compress from 'compression';\nimport helmet from 'helmet';\nimport methodOverride from 'method-override';\nimport passport from \"passport\";\nimport jwtStrategy from './middleware/jwtStrategy';\npassport.use(jwtStrategy)\n\nimport mongoose from 'mongoose';\nmongoose.Promise = global.Promise;;\nmongoose.connect(config.mongoURL, { useMongoClient: true });\nimport fetchLeagues from './userRoutes/fetchLeagues';\nimport queryOdds from './userRoutes/queryOdds';\nimport straightWagerSubmit from './userRoutes/straightWagerSubmit';\nimport parlayWagerSubmit from './userRoutes/parlayWagerSubmit'; \nimport fetchUserOpenBets from './userRoutes/fetchUserOpenBets';\nimport fetchUserHistoryBets from './userRoutes/fetchUserHistoryBets';\nimport fetchUserState from './userRoutes/fetchUserState';\nimport userUtils from './userRoutes/userUtils';\n\nimport fetchAgentState from './agentRoutes/fetchAgentState';\nimport fetchAgentTransactions from './agentRoutes/fetchAgentTransactions';\nimport fetchAgentOpenBets from './agentRoutes/fetchAgentOpenBets';\nimport fetchAgentHistoryBets from './agentRoutes/fetchAgentHistoryBets';\nimport fetchAgentUserSetting from './agentRoutes/fetchAgentUserSetting';\n\nimport depositCreditToAgent from './superAgentRoutes/depositCreditToAgent'\n\nimport authLogin from './routes/authLogin';\nimport confirmEventsResult from './routes/confirmEventsResult';\n\nimport schedule from 'node-schedule';\nimport openBetPending from './schedule/openBetPending'\nimport openBetResult from './schedule/openBetResult'\n\n\nlet app = express();\napp.server = http.createServer(app);\n\n// logger\napp.use(morgan('dev'));\n\n// 3rd party middleware\napp.use(helmet());\napp.use(cors());\napp.use(compress());\napp.use(methodOverride());\n\napp.use(passport.initialize());\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\n\napp.use(express.static(path.resolve(__dirname, '../client/build')));\n\napp.get('/api', (req, res) => {\n\tres.send('test api')\n})\n\napp.use('/api', authLogin)\napp.use('/api', confirmEventsResult)\n\napp.use('/api/user', passport.authenticate('jwt', {session: false}))\napp.use('/api/user', fetchLeagues);\napp.use('/api/user', queryOdds);\napp.use('/api/user', straightWagerSubmit);\napp.use('/api/user', parlayWagerSubmit);\napp.use('/api/user', fetchUserOpenBets);\napp.use('/api/user', fetchUserHistoryBets);\napp.use('/api/user', fetchUserState);\napp.use('/api/user', userUtils);\n\napp.use('/api/agent', passport.authenticate('jwt', {session: false}));\napp.use('/api/agent', fetchAgentState);\napp.use('/api/agent', fetchAgentTransactions);\napp.use('/api/agent', fetchAgentOpenBets);\napp.use('/api/agent', fetchAgentHistoryBets);\napp.use('/api/agent', fetchAgentUserSetting);\n\n\napp.use('/api/super-agent', depositCreditToAgent)\n\napp.get('*', function(request, response) {\n  response.sendFile(path.resolve(__dirname, '../client/build', 'index.html'));\n});\n\nschedule.scheduleJob('59 * * * *', async function(){\n\tconsole.log(new Date())\n\tawait openBetPending()\n\tawait openBetResult()\n});\n\nschedule.scheduleJob('15 * * * *', async function(){\n\tconsole.log(new Date())\n\tawait openBetPending()\n\tawait openBetResult()\n});\n\nschedule.scheduleJob('30 * * * *', async function(){\n\tconsole.log(new Date())\n\tawait openBetPending()\n\tawait openBetResult()\n});\n\nschedule.scheduleJob('48 * * * *', async function(){\n\tconsole.log(new Date())\n\tawait openBetPending()\n\tawait openBetResult()\n});\n\napp.server.listen(process.env.PORT || 8080, () => {\n\tconsole.log(`Started on port ${app.server.address().port}`);\n});\n\nexport default app;\n"]}